import{a$ as e,cc as t,M as a,t as o,z as n,v as l,bC as s,W as i,_ as r,d as u,bD as p,bz as d,c,b as f,s as m,r as v,bJ as y,cd as x,ce as h,N as g,af as b,I as w,o as S,U as C,aj as z,g as k,f as I,h as E,P,C as j,n as F,i as N,l as $,e as B,w as M,D as _,E as V,Z as R,j as H,by as T,F as L,k as O,H as W,ae as U,q as A}from"./index.DRPoGZBk.js";import{m as D}from"./typescript.CRqm1_SZ.js";import{u as K}from"./index.F5OfedVa.js";import{U as q,I as J,C as Y}from"./event.BwRzfsZt.js";import{u as Z}from"./index.CQZWqeco.js";import{b as G,u as Q,a as X,c as ee}from"./use-form-common-props.DsMPcFL7.js";import{u as te,a as ae}from"./index.cDg2wPYz.js";import{d as oe}from"./error.D_Dr4eZ1.js";let ne;const le={height:"0",visibility:"hidden",overflow:t()?"":"hidden",position:"absolute","z-index":"-1000",top:"0",right:"0"},se=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing","word-break"];function ie(t,a=1,o){var n,l;ne||(ne=document.createElement("textarea"),(null!=(n=t.parentNode)?n:document.body).appendChild(ne));const{paddingSize:s,borderSize:i,boxSizing:r,contextStyle:u}=function(e){const t=window.getComputedStyle(e),a=t.getPropertyValue("box-sizing"),o=Number.parseFloat(t.getPropertyValue("padding-bottom"))+Number.parseFloat(t.getPropertyValue("padding-top")),n=Number.parseFloat(t.getPropertyValue("border-bottom-width"))+Number.parseFloat(t.getPropertyValue("border-top-width"));return{contextStyle:se.map(e=>[e,t.getPropertyValue(e)]),paddingSize:o,borderSize:n,boxSizing:a}}(t);u.forEach(([e,t])=>null==ne?void 0:ne.style.setProperty(e,t)),Object.entries(le).forEach(([e,t])=>null==ne?void 0:ne.style.setProperty(e,t,"important")),ne.value=t.value||t.placeholder||"";let p=ne.scrollHeight;const d={};"border-box"===r?p+=i:"content-box"===r&&(p-=s),ne.value="";const c=ne.scrollHeight-s;if(e(a)){let e=c*a;"border-box"===r&&(e=e+s+i),p=Math.max(e,p),d.minHeight=`${e}px`}if(e(o)){let e=c*o;"border-box"===r&&(e=e+s+i),p=Math.min(e,p)}return d.height=`${p}px`,null==(l=ne.parentNode)||l.removeChild(ne),ne=void 0,d}const re=o({id:{type:String,default:void 0},size:i,disabled:Boolean,modelValue:{type:n([String,Number,Object]),default:""},maxlength:{type:[String,Number]},minlength:{type:[String,Number]},type:{type:String,default:"text"},resize:{type:String,values:["none","both","horizontal","vertical"]},autosize:{type:n([Boolean,Object]),default:!1},autocomplete:{type:n(String),default:"off"},formatter:{type:Function},parser:{type:Function},placeholder:{type:String},form:{type:String},readonly:Boolean,clearable:Boolean,clearIcon:{type:l,default:s},showPassword:Boolean,showWordLimit:Boolean,suffixIcon:{type:l},prefixIcon:{type:l},containerRole:{type:String,default:void 0},tabindex:{type:[String,Number],default:0},validateEvent:{type:Boolean,default:!0},inputStyle:{type:n([Object,Array,String]),default:()=>D({})},autofocus:Boolean,rows:{type:Number,default:2},...K(["ariaLabel"]),inputmode:{type:n(String),default:void 0},name:String}),ue={[q]:e=>a(e),input:e=>a(e),change:e=>a(e),focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent,clear:()=>!0,mouseleave:e=>e instanceof MouseEvent,mouseenter:e=>e instanceof MouseEvent,keydown:e=>e instanceof Event,compositionstart:e=>e instanceof CompositionEvent,compositionupdate:e=>e instanceof CompositionEvent,compositionend:e=>e instanceof CompositionEvent};const pe=u({name:"ElInput",inheritAttrs:!1});const de=A(r(u({...pe,props:re,emits:ue,setup(e,{expose:t,emit:a}){const o=e,n=p(),l=Z(),s=d(),i=c(()=>["textarea"===o.type?se.b():le.b(),le.m(K.value),le.is("disabled",ne.value),le.is("exceed",Fe.value),{[le.b("group")]:s.prepend||s.append,[le.m("prefix")]:s.prefix||o.prefixIcon,[le.m("suffix")]:s.suffix||o.suffixIcon||o.clearable||o.showPassword,[le.bm("suffix","password-clear")]:Ie.value&&Ee.value,[le.b("hidden")]:"hidden"===o.type},n.class]),r=c(()=>[le.e("wrapper"),le.is("focus",ye.value)]),{form:u,formItem:A}=X(),{inputId:D}=ee(o,{formItemContext:A}),K=G(),ne=Q(),le=f("input"),se=f("textarea"),re=m(),ue=m(),pe=v(!1),de=v(!1),ce=v(),fe=m(o.inputStyle),me=c(()=>re.value||ue.value),{wrapperRef:ve,isFocused:ye,handleFocus:xe,handleBlur:he}=te(me,{disabled:ne,afterBlur(){var e;o.validateEvent&&(null==(e=null==A?void 0:A.validate)||e.call(A,"blur").catch(e=>oe()))}}),ge=c(()=>{var e;return null!=(e=null==u?void 0:u.statusIcon)&&e}),be=c(()=>(null==A?void 0:A.validateState)||""),we=c(()=>be.value&&y[be.value]),Se=c(()=>de.value?x:h),Ce=c(()=>[n.style]),ze=c(()=>[o.inputStyle,fe.value,{resize:o.resize}]),ke=c(()=>g(o.modelValue)?"":String(o.modelValue)),Ie=c(()=>o.clearable&&!ne.value&&!o.readonly&&!!ke.value&&(ye.value||pe.value)),Ee=c(()=>o.showPassword&&!ne.value&&!!ke.value),Pe=c(()=>o.showWordLimit&&!!o.maxlength&&("text"===o.type||"textarea"===o.type)&&!ne.value&&!o.readonly&&!o.showPassword),je=c(()=>ke.value.length),Fe=c(()=>!!Pe.value&&je.value>Number(o.maxlength)),Ne=c(()=>!!s.suffix||!!o.suffixIcon||Ie.value||o.showPassword||Pe.value||!!be.value&&ge.value),[$e,Be]=function(e){let t;return[function(){if(null==e.value)return;const{selectionStart:a,selectionEnd:o,value:n}=e.value;if(null==a||null==o)return;const l=n.slice(0,Math.max(0,a)),s=n.slice(Math.max(0,o));t={selectionStart:a,selectionEnd:o,value:n,beforeTxt:l,afterTxt:s}},function(){if(null==e.value||null==t)return;const{value:a}=e.value,{beforeTxt:o,afterTxt:n,selectionStart:l}=t;if(null==o||null==n||null==l)return;let s=a.length;if(a.endsWith(n))s=a.length-n.length;else if(a.startsWith(o))s=o.length;else{const e=o[l-1],t=a.indexOf(e,l-1);-1!==t&&(s=t+1)}e.value.setSelectionRange(s,s)}]}(re);b(ue,e=>{if(_e(),!Pe.value||"both"!==o.resize)return;const t=e[0],{width:a}=t.contentRect;ce.value={right:`calc(100% - ${a+15+6}px)`}});const Me=()=>{const{type:e,autosize:t}=o;if(W&&"textarea"===e&&ue.value)if(t){const e=U(t)?t.minRows:void 0,a=U(t)?t.maxRows:void 0,o=ie(ue.value,e,a);fe.value={overflowY:"hidden",...o},C(()=>{ue.value.offsetHeight,fe.value=o})}else fe.value={minHeight:ie(ue.value).minHeight}},_e=(e=>{let t=!1;return()=>{var a;if(t||!o.autosize)return;null===(null==(a=ue.value)?void 0:a.offsetParent)||(setTimeout(e),t=!0)}})(Me),Ve=()=>{const e=me.value,t=o.formatter?o.formatter(ke.value):ke.value;e&&e.value!==t&&(e.value=t)},Re=async e=>{$e();let{value:t}=e.target;o.formatter&&o.parser&&(t=o.parser(t)),Te.value||(t!==ke.value?(a(q,t),a(J,t),await C(),Ve(),Be()):Ve())},He=e=>{let{value:t}=e.target;o.formatter&&o.parser&&(t=o.parser(t)),a(Y,t)},{isComposing:Te,handleCompositionStart:Le,handleCompositionUpdate:Oe,handleCompositionEnd:We}=ae({emit:a,afterComposition:Re}),Ue=()=>{$e(),de.value=!de.value,setTimeout(Be)},Ae=e=>{pe.value=!1,a("mouseleave",e)},De=e=>{pe.value=!0,a("mouseenter",e)},Ke=e=>{a("keydown",e)},qe=()=>{a(q,""),a(Y,""),a("clear"),a(J,"")};return w(()=>o.modelValue,()=>{var e;C(()=>Me()),o.validateEvent&&(null==(e=null==A?void 0:A.validate)||e.call(A,"change").catch(e=>oe()))}),w(ke,()=>Ve()),w(()=>o.type,async()=>{await C(),Ve(),Me()}),S(()=>{!o.formatter&&o.parser,Ve(),C(Me)}),t({input:re,textarea:ue,ref:me,textareaStyle:ze,autosize:z(o,"autosize"),isComposing:Te,focus:()=>{var e;return null==(e=me.value)?void 0:e.focus()},blur:()=>{var e;return null==(e=me.value)?void 0:e.blur()},select:()=>{var e;null==(e=me.value)||e.select()},clear:qe,resizeTextarea:Me}),(e,t)=>(I(),k("div",{class:F([N(i),{[N(le).bm("group","append")]:e.$slots.append,[N(le).bm("group","prepend")]:e.$slots.prepend}]),style:O(N(Ce)),onMouseenter:De,onMouseleave:Ae},[E(" input "),"textarea"!==e.type?(I(),k(P,{key:0},[E(" prepend slot "),e.$slots.prepend?(I(),k("div",{key:0,class:F(N(le).be("group","prepend"))},[$(e.$slots,"prepend")],2)):E("v-if",!0),j("div",{ref_key:"wrapperRef",ref:ve,class:F(N(r))},[E(" prefix slot "),e.$slots.prefix||e.prefixIcon?(I(),k("span",{key:0,class:F(N(le).e("prefix"))},[j("span",{class:F(N(le).e("prefix-inner"))},[$(e.$slots,"prefix"),e.prefixIcon?(I(),B(N(V),{key:0,class:F(N(le).e("icon"))},{default:M(()=>[(I(),B(_(e.prefixIcon)))]),_:1},8,["class"])):E("v-if",!0)],2)],2)):E("v-if",!0),j("input",R({id:N(D),ref_key:"input",ref:re,class:N(le).e("inner")},N(l),{name:e.name,minlength:e.minlength,maxlength:e.maxlength,type:e.showPassword?de.value?"text":"password":e.type,disabled:N(ne),readonly:e.readonly,autocomplete:e.autocomplete,tabindex:e.tabindex,"aria-label":e.ariaLabel,placeholder:e.placeholder,style:e.inputStyle,form:e.form,autofocus:e.autofocus,role:e.containerRole,inputmode:e.inputmode,onCompositionstart:N(Le),onCompositionupdate:N(Oe),onCompositionend:N(We),onInput:Re,onChange:He,onKeydown:Ke}),null,16,["id","name","minlength","maxlength","type","disabled","readonly","autocomplete","tabindex","aria-label","placeholder","form","autofocus","role","inputmode","onCompositionstart","onCompositionupdate","onCompositionend"]),E(" suffix slot "),N(Ne)?(I(),k("span",{key:1,class:F(N(le).e("suffix"))},[j("span",{class:F(N(le).e("suffix-inner"))},[N(Ie)&&N(Ee)&&N(Pe)?E("v-if",!0):(I(),k(P,{key:0},[$(e.$slots,"suffix"),e.suffixIcon?(I(),B(N(V),{key:0,class:F(N(le).e("icon"))},{default:M(()=>[(I(),B(_(e.suffixIcon)))]),_:1},8,["class"])):E("v-if",!0)],64)),N(Ie)?(I(),B(N(V),{key:1,class:F([N(le).e("icon"),N(le).e("clear")]),onMousedown:H(N(T),["prevent"]),onClick:qe},{default:M(()=>[(I(),B(_(e.clearIcon)))]),_:1},8,["class","onMousedown"])):E("v-if",!0),N(Ee)?(I(),B(N(V),{key:2,class:F([N(le).e("icon"),N(le).e("password")]),onClick:Ue},{default:M(()=>[(I(),B(_(N(Se))))]),_:1},8,["class"])):E("v-if",!0),N(Pe)?(I(),k("span",{key:3,class:F(N(le).e("count"))},[j("span",{class:F(N(le).e("count-inner"))},L(N(je))+" / "+L(e.maxlength),3)],2)):E("v-if",!0),N(be)&&N(we)&&N(ge)?(I(),B(N(V),{key:4,class:F([N(le).e("icon"),N(le).e("validateIcon"),N(le).is("loading","validating"===N(be))])},{default:M(()=>[(I(),B(_(N(we))))]),_:1},8,["class"])):E("v-if",!0)],2)],2)):E("v-if",!0)],2),E(" append slot "),e.$slots.append?(I(),k("div",{key:1,class:F(N(le).be("group","append"))},[$(e.$slots,"append")],2)):E("v-if",!0)],64)):(I(),k(P,{key:1},[E(" textarea "),j("textarea",R({id:N(D),ref_key:"textarea",ref:ue,class:[N(se).e("inner"),N(le).is("focus",N(ye))]},N(l),{minlength:e.minlength,maxlength:e.maxlength,tabindex:e.tabindex,disabled:N(ne),readonly:e.readonly,autocomplete:e.autocomplete,style:N(ze),"aria-label":e.ariaLabel,placeholder:e.placeholder,form:e.form,autofocus:e.autofocus,rows:e.rows,role:e.containerRole,onCompositionstart:N(Le),onCompositionupdate:N(Oe),onCompositionend:N(We),onInput:Re,onFocus:N(xe),onBlur:N(he),onChange:He,onKeydown:Ke}),null,16,["id","minlength","maxlength","tabindex","disabled","readonly","autocomplete","aria-label","placeholder","form","autofocus","rows","role","onCompositionstart","onCompositionupdate","onCompositionend","onFocus","onBlur"]),N(Pe)?(I(),k("span",{key:0,style:O(ce.value),class:F(N(le).e("count"))},L(N(je))+" / "+L(e.maxlength),7)):E("v-if",!0)],64))],38))}}),[["__file","input.vue"]]));export{de as E};
