import{bk as e,d as a,r as t,S as i,o as l,g as s,f as o,C as r,m as n,w as m,a3 as d,i as p,a4 as u,$ as c,e as f,h as g,aA as b,aG as j}from"./index.CM47KQtG.js";import{v as _}from"./loading.CxFowczj.js";import{E as h}from"./dialog.BtEbwb-q.js";import"./overlay.BreQExSd.js";import{E as v}from"./card.JRjeJkVW.js";import{_ as y}from"./index.DfSWtJFb.js";import{a as x,E as k}from"./table-column.agJiczKe.js";import"./checkbox.DwMVycN-.js";/* empty css                */import"./popper.Dy7mreVG.js";import"./scrollbar.DJ9OeN8B.js";/* empty css            */import{E as C,a as P}from"./form-item.BvU-fErQ.js";/* empty css               */import{E as V}from"./input.DICT-xuJ.js";/* empty css                    */import{E}from"./index.p5pvUZ8p.js";import{E as w}from"./index.DOFvcLEl.js";import"./index.BkpZJorq.js";import"./aria.Cpd_B0tV.js";import"./refs.Cw5r5QN8.js";import"./index.C-zw5LL5.js";import"./vnode.3FsO1Zr2.js";import"./event.BwRzfsZt.js";import"./error.D_Dr4eZ1.js";import"./scroll.HB0cktN2.js";import"./use-form-common-props.CwNouOR0.js";import"./pagination.BP_3TcMH.js";import"./select.CbuXqiqO.js";import"./index.DB7b8zJj.js";import"./token.DWNpOE8r.js";import"./strings.CuGzRR0G.js";import"./castArray.DwIa-ddT.js";import"./index.BM1Y5O9s.js";import"./debounce.BSbgIsNH.js";import"./toNumber.CTKVBeqF.js";import"./_baseIteratee.Bz4YUaFH.js";import"./index.BpEbxuRh.js";import"./index.ChhW_Tvf.js";import"./_plugin-vue_export-helper.BCo6x5W8.js";import"./_initCloneObject.D6_TlKeT.js";import"./raf.UU1-UmoM.js";import"./index.33C-WVq8.js";import"./_baseClone.C_H9MAg3.js";import"./index.DUp9k36Z.js";const U={fetchPermissions:a=>e.get("/api/permissions",{params:a}),getPermission:a=>e.get(`/api/permissions/${a}`),createPermission:a=>e.post("/api/permissions",a),updatePermission:(a,t)=>e.put(`/api/permissions/${a}`,t),deletePermission:a=>e.delete(`/api/permissions/${a}`),bulkDeletePermissions:a=>e.delete("/api/permissions",{data:{ids:a}})},A={class:"app-container"},N={class:"search-container"},D={class:"data-table__toolbar"},R={class:"data-table__toolbar--actions"},$={class:"dialog-footer"},F=a({name:"Permissions",inheritAttrs:!1,__name:"Index",setup(e){const a=t(),F=t(),G=t(!1),S=t([]),I=t(0),q=i({page:1,per_page:10}),z=t(),B=i({title:"",visible:!1}),O=i({}),T=i({name:[{required:!0,message:"Please enter name",trigger:"blur"}],guard_name:[{required:!0,message:"Please enter guard name",trigger:"blur"}]});async function K(){G.value=!0;try{const e=await U.fetchPermissions(q);z.value=e.data,I.value=e.meta.total}catch(e){}finally{G.value=!1}}function W(){q.page=Number(q.page)||1,K()}function Y(){a.value?.resetFields?.(),q.page=1,K()}function Z(e){S.value=e.map(e=>e.id)}function J(e){B.visible=!0,e?(B.title="Edit Permission",U.getPermission(e).then(e=>{Object.assign(O,e.data)})):(B.title="Add Permission",Object.keys(O).forEach(e=>O[e]=void 0))}function L(){F.value.validate(e=>{if(e){G.value=!0;const e=O.id;e?U.updatePermission(e,O).then(()=>{j.success("Updated successful"),M(),W()}).finally(()=>G.value=!1):U.createPermission(O).then(()=>{j.success("Created successful"),M(),K()}).finally(()=>G.value=!1)}})}function M(){B.visible=!1,F.value?.resetFields?.(),F.value?.clearValidate?.(),O.id=void 0}function Q(e){const a=void 0!==e?[e]:S.value;a&&0!==a.length?w.confirm("Are you sure to delete the selected item(s)?","WARNING",{confirmButtonText:"Confirm",cancelButtonText:"Cancel",type:"warning"}).then(async()=>{G.value=!0;try{await U.bulkDeletePermissions(a),j.success("Deleted successful"),W()}catch(e){j.error("Failed to delete permission(s)")}finally{G.value=!1}},()=>{j.info("Deletion Cancelled")}):j.warning("Please select item(s)")}return l(K),(e,t)=>{const i=V,l=C,j=E,w=P,U=k,X=x,H=y,ee=v,ae=h,te=_;return o(),s("div",A,[r("div",N,[n(w,{ref_key:"queryFormRef",ref:a,model:p(q),inline:!0},{default:m(()=>[n(l,{prop:"name",label:"Name"},{default:m(()=>[n(i,{modelValue:p(q).name,"onUpdate:modelValue":t[0]||(t[0]=e=>p(q).name=e),placeholder:"Enter name",clearable:"",onKeyup:d(W,["enter"])},null,8,["modelValue"])]),_:1}),n(l,{prop:"guard_name",label:"Guard Name"},{default:m(()=>[n(i,{modelValue:p(q).guard_name,"onUpdate:modelValue":t[1]||(t[1]=e=>p(q).guard_name=e),placeholder:"Enter guard name",clearable:"",onKeyup:d(W,["enter"])},null,8,["modelValue"])]),_:1}),n(l,{class:"search-buttons"},{default:m(()=>[n(j,{type:"primary",icon:"search",onClick:W},{default:m(()=>[...t[10]||(t[10]=[u("Search",-1)])]),_:1}),n(j,{icon:"refresh",onClick:Y},{default:m(()=>[...t[11]||(t[11]=[u("Reset",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),n(ee,{shadow:"hover",class:"data-table"},{default:m(()=>[r("div",D,[r("div",R,[n(j,{type:"success",icon:"plus",onClick:t[2]||(t[2]=e=>J())},{default:m(()=>[...t[12]||(t[12]=[u("Add",-1)])]),_:1}),n(j,{type:"danger",disabled:0===p(S).length,icon:"delete",onClick:t[3]||(t[3]=e=>Q())},{default:m(()=>[...t[13]||(t[13]=[u(" Delete ",-1)])]),_:1},8,["disabled"])])]),c((o(),f(X,{ref:"dataTableRef",data:p(z),"highlight-current-row":"",border:"",class:"data-table__content",onSelectionChange:Z},{default:m(()=>[n(U,{type:"selection",width:"55",align:"center"}),n(U,{label:"ID",prop:"id"}),n(U,{label:"Name",prop:"name"}),n(U,{label:"Guard Name",prop:"guard_name"}),n(U,{label:"Label",prop:"label"}),n(U,{fixed:"right",label:"Actions",width:"220"},{default:m(e=>[n(j,{type:"primary",size:"small",link:"",icon:"edit",onClick:a=>J(e.row.id)},{default:m(()=>[...t[14]||(t[14]=[u(" Edit ",-1)])]),_:1},8,["onClick"]),n(j,{type:"danger",size:"small",link:"",icon:"delete",onClick:a=>Q(e.row.id)},{default:m(()=>[...t[15]||(t[15]=[u(" Delete ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[te,p(G)]]),p(I)>0?(o(),f(H,{key:0,total:p(I),"onUpdate:total":t[4]||(t[4]=e=>b(I)?I.value=e:null),page:p(q).page,"onUpdate:page":t[5]||(t[5]=e=>p(q).page=e),limit:p(q).per_page,"onUpdate:limit":t[6]||(t[6]=e=>p(q).per_page=e),onPagination:K},null,8,["total","page","limit"])):g("",!0)]),_:1}),n(ae,{modelValue:p(B).visible,"onUpdate:modelValue":t[9]||(t[9]=e=>p(B).visible=e),title:p(B).title,width:"500px",onClose:M},{footer:m(()=>[r("div",$,[n(j,{type:"primary",onClick:L},{default:m(()=>[...t[16]||(t[16]=[u("Submit",-1)])]),_:1}),n(j,{onClick:M},{default:m(()=>[...t[17]||(t[17]=[u("Cancel",-1)])]),_:1})])]),default:m(()=>[n(w,{ref_key:"roleFormRef",ref:F,model:p(O),rules:p(T),"label-width":"100px"},{default:m(()=>[n(l,{label:"Name",prop:"name"},{default:m(()=>[n(i,{modelValue:p(O).name,"onUpdate:modelValue":t[7]||(t[7]=e=>p(O).name=e),placeholder:"Enter name"},null,8,["modelValue"])]),_:1}),n(l,{label:"Guard",prop:"guard_name"},{default:m(()=>[n(i,{modelValue:p(O).guard_name,"onUpdate:modelValue":t[8]||(t[8]=e=>p(O).guard_name=e),placeholder:"Enter guard name"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}});export{F as default};
