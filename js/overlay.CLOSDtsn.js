import{bB as e,d as o,t,b as n,m as l,ab as a,l as s,z as u,v as r,r as d,o as i,R as c,aa as v,J as f,bE as m,aA as p,c as y,H as g,a6 as b,I as C,ca as h,a5 as E,bK as w,a7 as x,B,c2 as S,cb as L,cc as M,ae as k,ad as I,bz as z,ac as A,U as D}from"./index.B90-c5zJ.js";import{P as O}from"./vnode.7Ybx9K6U.js";import{t as Y}from"./index.D4gfPu2z.js";import{U as j}from"./event.BwRzfsZt.js";import{t as F}from"./error.D_Dr4eZ1.js";import{g as P}from"./scroll.DwzyEeEw.js";import{d as T}from"./use-form-common-props.CyHPSO6d.js";const X=o=>{if(!o)return{onClick:e,onMousedown:e,onMouseup:e};let t=!1,n=!1;return{onClick:e=>{t&&n&&o(e),t=n=!1},onMousedown:e=>{t=e.target===e.currentTarget},onMouseup:e=>{n=e.target===e.currentTarget}}},$=t({mask:{type:Boolean,default:!0},customMaskEvent:Boolean,overlayClass:{type:u([String,Array,Object])},zIndex:{type:u([String,Number])}});const N=o({name:"ElOverlay",props:$,emits:{click:e=>e instanceof MouseEvent},setup(e,{slots:o,emit:t}){const u=n("overlay"),{onClick:r,onMousedown:d,onMouseup:i}=X(e.customMaskEvent?void 0:e=>{t("click",e)});return()=>e.mask?l("div",{class:[u.b(),e.overlayClass],style:{zIndex:e.zIndex},onClick:r,onMousedown:d,onMouseup:i},[s(o,"default")],O.STYLE|O.CLASS|O.PROPS,["onClick","onMouseup","onMousedown"]):a("div",{class:e.overlayClass,style:{zIndex:e.zIndex,position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"}},[s(o,"default")])}}),R=Symbol("dialogInjectionKey"),H="dialog-fade",V=t({center:Boolean,alignCenter:{type:Boolean,default:void 0},closeIcon:{type:r},draggable:{type:Boolean,default:void 0},overflow:{type:Boolean,default:void 0},fullscreen:Boolean,headerClass:String,bodyClass:String,footerClass:String,showClose:{type:Boolean,default:!0},title:{type:String,default:""},ariaLevel:{type:String,default:"2"}}),_={close:()=>!0},q=(e,o,t,n)=>{const l={offsetX:0,offsetY:0},a=d(!1),s=(o,t)=>{if(e.value){const{offsetX:a,offsetY:s}=l,u=e.value.getBoundingClientRect(),r=u.left,d=u.top,i=u.width,c=u.height,v=document.documentElement.clientWidth,m=document.documentElement.clientHeight,p=-r+a,y=-d+s,g=v-r-i+a,b=m-d-(c<m?c:0)+s;(null==n?void 0:n.value)||(o=Math.min(Math.max(o,p),g),t=Math.min(Math.max(t,y),b)),l.offsetX=o,l.offsetY=t,e.value.style.transform=`translate(${f(o)}, ${f(t)})`}},u=e=>{const o=e.clientX,t=e.clientY,{offsetX:n,offsetY:u}=l,r=e=>{a.value||(a.value=!0);const l=n+e.clientX-o,r=u+e.clientY-t;s(l,r)},d=()=>{a.value=!1,document.removeEventListener("mousemove",r),document.removeEventListener("mouseup",d)};document.addEventListener("mousemove",r),document.addEventListener("mouseup",d)},r=()=>{o.value&&e.value&&(o.value.removeEventListener("mousedown",u),window.removeEventListener("resize",m))},m=()=>{const{offsetX:e,offsetY:o}=l;s(e,o)};return i(()=>{c(()=>{t.value?o.value&&e.value&&(o.value.addEventListener("mousedown",u),window.addEventListener("resize",m)):r()})}),v(()=>{r()}),{isDragging:a,resetPosition:()=>{l.offsetX=0,l.offsetY=0,e.value&&(e.value.style.transform="")},updatePosition:m}},K=t({...V,appendToBody:Boolean,appendTo:{type:Y.to.type,default:"body"},beforeClose:{type:u(Function)},destroyOnClose:Boolean,closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},modal:{type:Boolean,default:!0},modalPenetrable:Boolean,openDelay:{type:Number,default:0},closeDelay:{type:Number,default:0},top:{type:String},modelValue:Boolean,modalClass:String,headerClass:String,bodyClass:String,footerClass:String,width:{type:[String,Number]},zIndex:{type:Number},trapFocus:Boolean,headerAriaLevel:{type:String,default:"2"},transition:{type:u([String,Object]),default:void 0}}),U={open:()=>!0,opened:()=>!0,close:()=>!0,closed:()=>!0,[j]:e=>m(e),openAutoFocus:()=>!0,closeAutoFocus:()=>!0},J=(e,o={})=>{p(e)||F("[useLockscreen]","You need to pass a ref param to this function");const t=o.ns||n("popup"),l=y(()=>t.bm("parent","hidden"));if(!g||b(document.body,l.value))return;let a=0,s=!1,u="0";const r=()=>{setTimeout(()=>{"undefined"!=typeof document&&s&&document&&(document.body.style.width=u,x(document.body,l.value))},200)};C(e,e=>{if(!e)return void r();s=!b(document.body,l.value),s&&(u=document.body.style.width,E(document.body,l.value)),a=P(t.namespace.value);const o=document.documentElement.clientHeight<document.body.scrollHeight,n=w(document.body,"overflowY");a>0&&(o||"scroll"===n)&&s&&(document.body.style.width=`calc(100% - ${a}px)`)}),h(()=>r())},W=(e,o)=>{var t;const n=B().emit,{nextZIndex:l}=S();let a="";const s=T(),u=T(),r=d(!1),c=d(!1),v=d(!1),m=d(null!=(t=e.zIndex)?t:l());let p,b;const h=L(),E=y(()=>{var e,o;return null!=(o=null==(e=h.value)?void 0:e.namespace)?o:M}),w=y(()=>{var e;return null==(e=h.value)?void 0:e.dialog}),x=y(()=>{const o={},t=`--${E.value}-dialog`;return e.fullscreen||(e.top&&(o[`${t}-margin-top`]=e.top),e.width&&(o[`${t}-width`]=f(e.width))),o}),O=y(()=>{var o,t,n;return null!=(n=null!=(t=e.draggable)?t:null==(o=w.value)?void 0:o.draggable)&&n&&!e.fullscreen}),Y=y(()=>{var o,t,n;return null!=(n=null!=(t=e.alignCenter)?t:null==(o=w.value)?void 0:o.alignCenter)&&n}),F=y(()=>{var o,t,n;return null!=(n=null!=(t=e.overflow)?t:null==(o=w.value)?void 0:o.overflow)&&n}),P=y(()=>Y.value?{display:"flex"}:{}),X=y(()=>{var o,t,n;const l=null!=(n=null!=(t=e.transition)?t:null==(o=w.value)?void 0:o.transition)?n:H,a={name:l,onAfterEnter:$,onBeforeLeave:R,onAfterLeave:N};if(k(l)){const e={...l},o=(e,o)=>t=>{I(e)?e.forEach(e=>{z(e)&&e(t)}):z(e)&&e(t),o()};return e.onAfterEnter=o(e.onAfterEnter,$),e.onBeforeLeave=o(e.onBeforeLeave,R),e.onAfterLeave=o(e.onAfterLeave,N),e.name||(e.name=H),e}return a});function $(){n("opened")}function N(){n("closed"),n(j,!1),e.destroyOnClose&&(v.value=!1)}function R(){n("close")}function V(){null==b||b(),null==p||p(),e.openDelay&&e.openDelay>0?({stop:p}=A(()=>K(),e.openDelay)):K()}function _(){null==p||p(),null==b||b(),e.closeDelay&&e.closeDelay>0?({stop:b}=A(()=>U(),e.closeDelay)):U()}function q(){e.beforeClose?e.beforeClose(function(e){e||(c.value=!0,r.value=!1)}):_()}function K(){g&&(r.value=!0)}function U(){r.value=!1}return e.lockScroll&&J(r),C(()=>e.zIndex,()=>{var o;m.value=null!=(o=e.zIndex)?o:l()}),C(()=>e.modelValue,t=>{var a;t?(c.value=!1,V(),v.value=!0,m.value=null!=(a=e.zIndex)?a:l(),D(()=>{n("open"),o.value&&(o.value.parentElement.scrollTop=0,o.value.parentElement.scrollLeft=0,o.value.scrollTop=0)})):r.value&&_()}),C(()=>e.fullscreen,e=>{o.value&&(e?(a=o.value.style.transform,o.value.style.transform=""):o.value.style.transform=a)}),i(()=>{e.modelValue&&(r.value=!0,v.value=!0,V())}),{afterEnter:$,afterLeave:N,beforeLeave:R,handleClose:q,onModalClick:function(){e.closeOnClickModal&&q()},close:_,doClose:U,onOpenAutoFocus:function(){n("openAutoFocus")},onCloseAutoFocus:function(){n("closeAutoFocus")},onCloseRequested:function(){e.closeOnPressEscape&&q()},onFocusoutPrevented:function(e){var o;"pointer"===(null==(o=e.detail)?void 0:o.focusReason)&&e.preventDefault()},titleId:s,bodyId:u,closed:c,style:x,overlayDialogStyle:P,rendered:v,visible:r,zIndex:m,transitionConfig:X,_draggable:O,_alignCenter:Y,_overflow:F}};export{N as E,K as a,q as b,J as c,U as d,X as e,_ as f,V as g,R as h,W as u};
