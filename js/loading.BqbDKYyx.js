import{r as e,S as t,df as n,aP as o,d as l,ci as s,ab as i,w as a,$ as r,m as u,a1 as c,T as d,a7 as v,H as b,U as g,M as m,bK as f,a5 as p,ae as x,aA as y,dg as C}from"./index.B90-c5zJ.js";function A(b,g){let m;const f=e(!1),p=t({...b,originalPosition:"",originalOverflow:"",visible:!1});function x(){var e,t;null==(t=null==(e=k.$el)?void 0:e.parentNode)||t.removeChild(k.$el)}function y(){if(!f.value)return;const e=p.parent;f.value=!1,e.vLoadingAddClassList=void 0,function(){const e=p.parent,t=k.ns;if(!e.vLoadingAddClassList){let n=e.getAttribute("loading-number");n=Number.parseInt(n)-1,n?e.setAttribute("loading-number",n.toString()):(v(e,t.bm("parent","relative")),e.removeAttribute("loading-number")),v(e,t.bm("parent","hidden"))}x(),A.unmount()}()}const C=l({name:"ElLoading",setup(e,{expose:t}){const{ns:n,zIndex:o}=s("loading");return t({ns:n,zIndex:o}),()=>{const e=p.spinner||p.svg,t=i("svg",{class:"circular",viewBox:p.svgViewBox?p.svgViewBox:"0 0 50 50",...e?{innerHTML:e}:{}},[i("circle",{class:"path",cx:"25",cy:"25",r:"20",fill:"none"})]),o=p.text?i("p",{class:n.b("text")},[p.text]):void 0;return i(d,{name:n.b("fade"),onAfterLeave:y},{default:a(()=>[r(u("div",{style:{backgroundColor:p.background||""},class:[n.b("mask"),p.customClass,p.fullscreen?"is-fullscreen":""]},[i("div",{class:n.b("spinner")},[t,o])]),[[c,p.visible]])])})}}}),A=n(C);Object.assign(A._context,null!=g?g:{});const k=A.mount(document.createElement("div"));return{...o(p),setText:function(e){p.text=e},removeElLoadingChild:x,close:function(){var e;b.beforeClose&&!b.beforeClose()||(f.value=!0,clearTimeout(m),m=setTimeout(y,400),p.visible=!1,null==(e=b.closed)||e.call(b))},handleAfterLeave:y,vm:k,get $el(){return k.$el}}}let k;const w=function(e={},t){if(!b)return;const n=L(e);if(n.fullscreen&&k)return k;const o=A({...n,closed:()=>{var e;null==(e=n.closed)||e.call(n),n.fullscreen&&(k=void 0)}},null!=t?t:w._context);h(n,n.parent,o),B(n,n.parent,o),n.parent.vLoadingAddClassList=()=>B(n,n.parent,o);let l=n.parent.getAttribute("loading-number");return l=l?`${Number.parseInt(l)+1}`:"1",n.parent.setAttribute("loading-number",l),n.parent.appendChild(o.$el),g(()=>o.visible.value=n.visible),n.fullscreen&&(k=o),o},L=e=>{var t,n,o,l;let s;return s=m(e.target)?null!=(t=document.querySelector(e.target))?t:document.body:e.target||document.body,{parent:s===document.body||e.body?document.body:s,background:e.background||"",svg:e.svg||"",svgViewBox:e.svgViewBox||"",spinner:e.spinner||!1,text:e.text||"",fullscreen:s===document.body&&(null==(n=e.fullscreen)||n),lock:null!=(o=e.lock)&&o,customClass:e.customClass||"",visible:null==(l=e.visible)||l,beforeClose:e.beforeClose,closed:e.closed,target:s}},h=async(e,t,n)=>{const{nextZIndex:o}=n.vm.zIndex||n.vm._.exposed.zIndex,l={};if(e.fullscreen)n.originalPosition.value=f(document.body,"position"),n.originalOverflow.value=f(document.body,"overflow"),l.zIndex=o();else if(e.parent===document.body){n.originalPosition.value=f(document.body,"position"),await g();for(const t of["top","left"]){const n="top"===t?"scrollTop":"scrollLeft";l[t]=e.target.getBoundingClientRect()[t]+document.body[n]+document.documentElement[n]-Number.parseInt(f(document.body,`margin-${t}`),10)+"px"}for(const t of["height","width"])l[t]=`${e.target.getBoundingClientRect()[t]}px`}else n.originalPosition.value=f(t,"position");for(const[s,i]of Object.entries(l))n.$el.style[s]=i},B=(e,t,n)=>{const o=n.vm.ns||n.vm._.exposed.ns;["absolute","fixed","sticky"].includes(n.originalPosition.value)?v(t,o.bm("parent","relative")):p(t,o.bm("parent","relative")),e.fullscreen&&e.lock?p(t,o.bm("parent","hidden")):v(t,o.bm("parent","hidden"))};w._context=null;const $=Symbol("ElLoading"),I=e=>`element-loading-${C(e)}`,V=(t,n)=>{var o,l,s,i;const a=n.instance,r=e=>x(n.value)?n.value[e]:void 0,u=n=>(t=>{const n=m(t)&&(null==a?void 0:a[t])||t;return e(n)})(r(n)||t.getAttribute(I(n))),c=null!=(o=r("fullscreen"))?o:n.modifiers.fullscreen,d={text:u("text"),svg:u("svg"),svgViewBox:u("svgViewBox"),spinner:u("spinner"),background:u("background"),customClass:u("customClass"),fullscreen:c,target:null!=(l=r("target"))?l:c?void 0:t,body:null!=(s=r("body"))?s:n.modifiers.body,lock:null!=(i=r("lock"))?i:n.modifiers.lock},v=w(d);v._context=_._context,t[$]={options:d,instance:v}},_={mounted(e,t){t.value&&V(e,t)},updated(e,t){const n=e[$];if(!t.value)return null==n||n.instance.close(),void(e[$]=null);n?((e,t)=>{for(const n of Object.keys(e))y(e[n])&&(e[n].value=t[n])})(n.options,x(t.value)?t.value:{text:e.getAttribute(I("text")),svg:e.getAttribute(I("svg")),svgViewBox:e.getAttribute(I("svgViewBox")),spinner:e.getAttribute(I("spinner")),background:e.getAttribute(I("background")),customClass:e.getAttribute(I("customClass"))}):V(e,t)},unmounted(e){var t;null==(t=e[$])||t.instance.close(),e[$]=null},_context:null};export{w as L,_ as v};
