import{d as e,bK as t,bL as l,r as a,I as s,ar as i,g as u,f as n,m as r,k as o,i as p,az as d,w as m,a4 as c,F as f,C as y,E as v,j as g,dI as _,e as h,P as j,o as b,h as x}from"./index.DRPoGZBk.js";import{E as w,a as C}from"./form-item.BX728IAv.js";import{E as k}from"./upload.PyYNndzD.js";import{E as F}from"./progress.CHZRpn5t.js";/* empty css               */import{F as S}from"./file-api.DGfbDBKw.js";/* empty css                */import{E as V}from"./index.CATG-Bau.js";import{E as z}from"./index.CHumVb_u.js";import{_ as M}from"./_plugin-vue_export-helper.BCo6x5W8.js";import{E,a as I}from"./image-viewer.CRnANsF-.js";import{E as O}from"./link.CM2ZuMlr.js";import"./use-form-common-props.DsMPcFL7.js";import"./castArray.DubCdOyv.js";import"./error.D_Dr4eZ1.js";import"./_baseClone.CEh0Izpu.js";import"./_initCloneObject.CljjGAhF.js";import"./typescript.CRqm1_SZ.js";import"./index.C88r2BaC.js";import"./index.SISkM0HS.js";import"./aria.Cpd_B0tV.js";import"./debounce.DQPPIhOy.js";import"./toNumber.BFSSBEJo.js";import"./index.CQZWqeco.js";import"./scroll.EvVlGgaK.js";const N={key:0,class:"el-upload-list__item-info"},L=["onClick"],U={class:"el-upload-list__item-file-name"},D=["onClick"],W={key:1,class:"el-upload-list__item-info"},P=M(e({__name:"FileUpload",props:t({data:{type:Object,default:()=>({})},name:{type:String,default:"file"},limit:{type:Number,default:10},maxFileSize:{type:Number,default:10},accept:{type:String,default:"*"},uploadBtnText:{type:String,default:"上传文件"},style:{type:Object,default:()=>({width:"300px"})}},{modelValue:{type:[Array],required:!0,default:()=>[]},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const t=e,_=l(e,"modelValue"),h=a([]);function j(e){return!(e.size>1024*t.maxFileSize*1024)||(z.warning("上传文件不能大于"+t.maxFileSize+"M"),!1)}function b(e){return new Promise((l,a)=>{const s=e.file,i=new FormData;i.append(t.name,s),Object.keys(t.data).forEach(e=>{i.append(e,t.data[e])}),S.upload(i,e=>{const t=s.uid,l=h.value.find(e=>e.uid===t);l&&(l.percentage=e)}).then(e=>{l(e)}).catch(e=>{a(e)})})}s(_,e=>{h.value=e.map(e=>({name:e.name?e.name:e.url?.substring(e.url.lastIndexOf("/")+1),url:e.url,status:"success",uid:Date.now()<<13|Math.floor(8192*Math.random())}))},{immediate:!0});const x=(e,t,l)=>{if(z.success("上传成功"),l.every(e=>"success"===e.status||"fail"===e.status)){const e=[];l.map(t=>{if("success"===t.status){const l=t.response;l&&e.push({name:l.name,url:l.url})}else h.value.splice(h.value.findIndex(e=>e.uid===t.uid),1)}),e.length>0&&(_.value=[..._.value,...e])}},w=e=>{z.error("上传失败")};return(e,l)=>{const a=V,s=i("Document"),C=v,z=i("Close"),M=F,E=k;return n(),u("div",null,[r(E,{"file-list":p(h),"onUpdate:fileList":l[0]||(l[0]=e=>d(h)?h.value=e:null),style:o(t.style),"before-upload":j,"http-request":b,"on-success":x,"on-error":w,accept:t.accept,limit:t.limit,multiple:""},{file:m(({file:e})=>["success"===e.status?(n(),u("div",N,[y("a",{class:"el-upload-list__item-name",onClick:t=>function(e){const{url:t,name:l}=e;t&&S.download(t,l)}(e)},[r(C,null,{default:m(()=>[r(s)]),_:1}),y("span",U,f(e.name),1),y("span",{class:"el-icon--close",onClick:g(t=>{return l=e.url,void S.delete(l).then(()=>{_.value=_.value.filter(e=>e.url!==l)});var l},["stop"])},[r(C,null,{default:m(()=>[r(z)]),_:1})],8,D)],8,L)])):(n(),u("div",W,[r(M,{style:{display:"inline-flex"},percentage:e.percentage},null,8,["percentage"])]))]),default:m(()=>[r(a,{type:"primary",disabled:p(h).length>=t.limit},{default:m(()=>[c(f(t.uploadBtnText),1)]),_:1},8,["disabled"])]),_:1},8,["file-list","style","accept","limit"])])}}}),[["__scopeId","data-v-007ca51b"]]),q=M(e({__name:"SingleImageUpload",props:t({data:{type:Object,default:()=>({})},name:{type:String,default:"file"},maxFileSize:{type:Number,default:10},accept:{type:String,default:"image/*"},style:{type:Object,default:()=>({width:"150px",height:"150px"})}},{modelValue:{type:String,default:()=>""},modelModifiers:{}}),emits:["update:modelValue"],setup(e){_(e=>({v25d788e4:t.style.width??"150px",v424efe59:t.style.height??"150px"}));const t=e,a=l(e,"modelValue");function s(e){return t.accept.split(",").map(e=>e.trim()).some(t=>"image/*"===t?e.type.startsWith("image/"):t.startsWith(".")?e.name.toLowerCase().endsWith(t):e.type===t)?!(e.size>1024*t.maxFileSize*1024)||(z.warning("上传图片不能大于"+t.maxFileSize+"M"),!1):(z.warning(`上传文件的格式不正确，仅支持：${t.accept}`),!1)}function o(e){return new Promise((l,a)=>{const s=e.file,i=new FormData;i.append(t.name,s),Object.keys(t.data).forEach(e=>{i.append(e,t.data[e])}),S.upload(i).then(e=>{l(e)}).catch(e=>{a(e)})})}function p(){}function d(){a.value=""}const c=e=>{z.success("上传成功"),a.value=e.url},f=e=>{z.error("上传失败: "+e.message)};return(e,l)=>{const y=E,_=i("CircleCloseFilled"),b=v,x=i("Plus"),w=k;return n(),h(w,{class:"single-upload","list-type":"picture-card","show-file-list":!1,accept:t.accept,"before-upload":s,"http-request":o,"on-success":c,"on-error":f},{default:m(()=>[a.value?(n(),u(j,{key:0},[r(y,{class:"single-upload__image",src:a.value,"preview-src-list":[a.value],onClick:g(p,["stop"])},null,8,["src","preview-src-list"]),r(b,{class:"single-upload__delete-btn",onClick:g(d,["stop"])},{default:m(()=>[r(_)]),_:1})],64)):(n(),h(b,{key:1},{default:m(()=>[r(x)]),_:1}))]),_:1},8,["accept"])}}}),[["__scopeId","data-v-bd22d71e"]]),A={style:{width:"100%"}},H=["src"],K={class:"el-upload-list__item-actions"},Q=["onClick"],Z=["onClick"],B=e({__name:"MultiImageUpload",props:t({data:{type:Object,default:()=>({})},name:{type:String,default:"file"},limit:{type:Number,default:10},maxFileSize:{type:Number,default:10},accept:{type:String,default:"image/*"}},{modelValue:{type:[Array],default:()=>[]},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const t=e,s=a(!1),o=a(0),c=l(e,"modelValue"),f=a([]);function g(e){return t.accept.split(",").map(e=>e.trim()).some(t=>"image/*"===t?e.type.startsWith("image/"):t.startsWith(".")?e.name.toLowerCase().endsWith(t):e.type===t)?!(e.size>1024*t.maxFileSize*1024)||(z.warning("上传图片不能大于"+t.maxFileSize+"M"),!1):(z.warning(`上传文件的格式不正确，仅支持：${t.accept}`),!1)}function _(e){return new Promise((l,a)=>{const s=e.file,i=new FormData;i.append(t.name,s),Object.keys(t.data).forEach(e=>{i.append(e,t.data[e])}),S.upload(i).then(e=>{l(e)}).catch(e=>{a(e)})})}function w(){z.warning("最多只能上传"+t.limit+"张图片")}const C=(e,t)=>{z.success("上传成功");const l=f.value.findIndex(e=>e.uid===t.uid);-1!==l&&(f.value[l].url=e.url,f.value[l].status="success",c.value[l]=e.url)},F=e=>{z.error("上传失败: "+e.message)},V=()=>{s.value=!1};return b(()=>{f.value=c.value.map(e=>({url:e}))}),(e,l)=>{const a=i("Plus"),b=v,z=i("zoom-in"),M=i("Delete"),E=k,O=I;return n(),u(j,null,[r(E,{"file-list":p(f),"onUpdate:fileList":l[0]||(l[0]=e=>d(f)?f.value=e:null),"list-type":"picture-card","before-upload":g,"http-request":_,"on-success":C,"on-error":F,"on-exceed":w,accept:t.accept,limit:t.limit,multiple:""},{file:m(({file:e})=>[y("div",A,[y("img",{class:"el-upload-list__item-thumbnail",src:e.url},null,8,H),y("span",K,[y("span",{onClick:t=>{return l=e.url,o.value=c.value.findIndex(e=>e===l),void(s.value=!0);var l}},[r(b,null,{default:m(()=>[r(z)]),_:1})],8,Q),y("span",{onClick:t=>{return l=e.url,void S.delete(l).then(()=>{const e=c.value.indexOf(l);-1!==e&&(c.value.splice(e,1),f.value.splice(e,1))});var l}},[r(b,null,{default:m(()=>[r(M)]),_:1})],8,Z)])])]),default:m(()=>[r(b,null,{default:m(()=>[r(a)]),_:1})]),_:1},8,["file-list","accept","limit"]),p(s)?(n(),h(O,{key:0,"zoom-rate":1.2,"initial-index":p(o),"url-list":c.value,onClose:V},null,8,["initial-index","url-list"])):x("",!0)],64)}}}),G={class:"app-container"},R=e({__name:"upload",setup(e){const t=a("https://s2.loli.net/2023/05/24/yNsxFC8rLHMZQcK.jpg"),l=a(["https://s2.loli.net/2023/05/24/yNsxFC8rLHMZQcK.jpg"]),s=a([{name:"照片1.jpg",url:"https://s2.loli.net/2023/05/24/yNsxFC8rLHMZQcK.jpg"},{name:"照片2.jpg",url:"https://s2.loli.net/2023/05/24/RuHFMwW4rG5lIqs.jpg"}]);return(e,a)=>{const i=O,o=q,f=w,y=P,v=C;return n(),u("div",G,[r(i,{href:"https://gitee.com/youlaiorg/vue3-element-admin/blob/master/src/views/demo/upload.vue",type:"primary",target:"_blank",class:"mb-10"},{default:m(()=>[...a[3]||(a[3]=[c(" 示例源码 请点击>>>> ",-1)])]),_:1}),r(v,null,{default:m(()=>[r(f,{label:"单图上传"},{default:m(()=>[r(o,{modelValue:p(t),"onUpdate:modelValue":a[0]||(a[0]=e=>d(t)?t.value=e:null)},null,8,["modelValue"])]),_:1}),r(f,{label:"多图上传"},{default:m(()=>[r(B,{modelValue:p(l),"onUpdate:modelValue":a[1]||(a[1]=e=>d(l)?l.value=e:null),limit:2},null,8,["modelValue"])]),_:1}),r(f,{label:"文件上传"},{default:m(()=>[r(y,{modelValue:p(s),"onUpdate:modelValue":a[2]||(a[2]=e=>d(s)?s.value=e:null)},null,8,["modelValue"])]),_:1})]),_:1})])}}});export{R as default};
