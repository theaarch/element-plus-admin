import{d as e,r as a,S as t,o as l,g as o,f as i,C as r,m as s,w as n,a3 as m,i as d,a4 as p,$ as u,e as c,h as f,az as j}from"./index.DRPoGZBk.js";import{v as g}from"./loading.DIBzycS9.js";import{E as _}from"./overlay.2CFaBIuz.js";import{E as b}from"./card.QxKCHOda.js";import{_ as y}from"./index.DBFSzPNP.js";import{a as h,E as v}from"./table-column.C2ueaBaa.js";import"./checkbox.HknQRT7E.js";/* empty css                */import"./popper.BU17CZ-L.js";import"./scrollbar.psmrftie.js";/* empty css            */import{E as x,a as w}from"./form-item.BX728IAv.js";/* empty css               */import{E as k}from"./input.CQ-26BBh.js";import{R as C}from"./roles.Ds-Fh_hy.js";/* empty css                *//* empty css                    */import{E as R}from"./index.CATG-Bau.js";import{E}from"./index.CHumVb_u.js";import{E as V}from"./index.B9FqeKvr.js";import"./vnode.BI5jxDcy.js";import"./index.SISkM0HS.js";import"./aria.Cpd_B0tV.js";import"./refs.Cw5r5QN8.js";import"./event.BwRzfsZt.js";import"./error.D_Dr4eZ1.js";import"./scroll.EvVlGgaK.js";import"./use-form-common-props.DsMPcFL7.js";import"./index.C88r2BaC.js";import"./pagination.HPmRLtz8.js";import"./select.Dg8cxWuu.js";import"./index.CjQJJCUT.js";import"./token.DWNpOE8r.js";import"./strings.aj8LsXir.js";import"./castArray.DubCdOyv.js";import"./index.cDg2wPYz.js";import"./debounce.DQPPIhOy.js";import"./toNumber.BFSSBEJo.js";import"./_baseIteratee.CeiHmyQH.js";import"./index.F5OfedVa.js";import"./index.CJYjkF3a.js";import"./typescript.CRqm1_SZ.js";import"./_plugin-vue_export-helper.BCo6x5W8.js";import"./_initCloneObject.CljjGAhF.js";import"./raf.Rxgr8PiF.js";import"./index.YVQhVyFI.js";import"./_baseClone.CEh0Izpu.js";import"./index.CQZWqeco.js";const N={class:"app-container"},A={class:"search-container"},U={class:"data-table__toolbar"},F={class:"data-table__toolbar--actions"},z={class:"dialog-footer"},D=e({name:"Role",inheritAttrs:!1,__name:"Index",setup(e){const D=a(),T=a(),q=a(!1),B=a([]),I=a(0),O=t({page:1,per_page:10}),P=t({title:"",visible:!1}),S=t({}),G=t({name:[{required:!0,message:"Please enter a role name.",trigger:"blur"}],guard_name:[{required:!0,message:"Please enter a guard name.",trigger:"blur"}]});async function K(){q.value=!0;try{const e=await C.fetchRoles(O);B.value=e.data??[],I.value=e.meta?.total??0}catch(e){}finally{q.value=!1}}function W(){O.page=Number(O.page)||1,K()}function X(){D.value?.resetFields?.(),O.page=1,W()}function Y(e){P.visible=!0,e?(P.title="Edit Role",C.getRole(e).then(e=>{Object.assign(S,e.data)})):(P.title="Add Role",Object.keys(S).forEach(e=>S[e]=void 0))}function $(){T.value.validate(async e=>{if(e){q.value=!0;try{const e=S.id;e?(await C.updateRole(e,S),E.success("Role updated successfully")):(await C.createRole(S),E.success("Role created successfully")),Z(),await K()}catch(a){}finally{q.value=!1}}})}function Z(){P.visible=!1,T.value?.resetFields?.(),S.id=void 0}return l(K),(e,a)=>{const t=k,l=x,H=R,J=w,L=v,M=h,Q=y,ee=b,ae=_,te=g;return i(),o("div",N,[r("div",A,[s(J,{ref_key:"queryFormRef",ref:D,model:d(O),inline:!0},{default:n(()=>[s(l,{prop:"name",label:"Name"},{default:n(()=>[s(t,{modelValue:d(O).name,"onUpdate:modelValue":a[0]||(a[0]=e=>d(O).name=e),placeholder:"Enter role name",clearable:"",onKeyup:m(W,["enter"])},null,8,["modelValue"])]),_:1}),s(l,{class:"search-buttons"},{default:n(()=>[s(H,{type:"primary",icon:"search",onClick:W},{default:n(()=>[...a[8]||(a[8]=[p("Search",-1)])]),_:1}),s(H,{icon:"refresh",onClick:X},{default:n(()=>[...a[9]||(a[9]=[p("Reset",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),s(ee,{shadow:"hover",class:"data-table"},{default:n(()=>[r("div",U,[r("div",F,[s(H,{type:"success",icon:"plus",onClick:a[1]||(a[1]=e=>Y())},{default:n(()=>[...a[10]||(a[10]=[p("Add",-1)])]),_:1})])]),u((i(),c(M,{ref:"dataTableRef",data:d(B),"highlight-current-row":"",border:"",class:"data-table__content"},{default:n(()=>[s(L,{label:"ID",prop:"id",width:"80"}),s(L,{label:"Name",prop:"name","min-width":"120"}),s(L,{label:"Guard Name",prop:"guard_name",width:"150"}),s(L,{fixed:"right",label:"Actions",width:"200"},{default:n(({row:e})=>[s(H,{type:"primary",size:"small",link:"",icon:"edit",onClick:a=>Y(e.id)},{default:n(()=>[...a[11]||(a[11]=[p(" Edit ",-1)])]),_:1},8,["onClick"]),s(H,{type:"danger",size:"small",link:"",icon:"delete",onClick:a=>async function(e){V.confirm("Are you sure you want to delete this role?","Warning",{confirmButtonText:"Confirm",cancelButtonText:"Cancel",type:"warning"}).then(async()=>{q.value=!0;try{await C.deleteRole(e),E.success("Role deleted successfully"),await K()}catch(a){}finally{q.value=!1}},()=>{E.info("Delete cancelled")})}(e.id)},{default:n(()=>[...a[12]||(a[12]=[p(" Delete ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[te,d(q)]]),d(I)>0?(i(),c(Q,{key:0,total:d(I),"onUpdate:total":a[2]||(a[2]=e=>j(I)?I.value=e:null),page:d(O).page,"onUpdate:page":a[3]||(a[3]=e=>d(O).page=e),limit:d(O).per_page,"onUpdate:limit":a[4]||(a[4]=e=>d(O).per_page=e),onPagination:K},null,8,["total","page","limit"])):f("",!0)]),_:1}),s(ae,{modelValue:d(P).visible,"onUpdate:modelValue":a[7]||(a[7]=e=>d(P).visible=e),title:d(P).title,width:"500px",onClose:Z},{footer:n(()=>[r("div",z,[s(H,{type:"primary",onClick:$},{default:n(()=>[...a[13]||(a[13]=[p("Confirm",-1)])]),_:1}),s(H,{onClick:Z},{default:n(()=>[...a[14]||(a[14]=[p("Cancel",-1)])]),_:1})])]),default:n(()=>[s(J,{ref_key:"roleFormRef",ref:T,"label-position":"top",model:d(S),rules:d(G),"label-width":"100px"},{default:n(()=>[s(l,{label:"Name",prop:"name"},{default:n(()=>[s(t,{modelValue:d(S).name,"onUpdate:modelValue":a[5]||(a[5]=e=>d(S).name=e),placeholder:"Enter role name"},null,8,["modelValue"])]),_:1}),s(l,{label:"Guard Name",prop:"guard_name"},{default:n(()=>[s(t,{modelValue:d(S).guard_name,"onUpdate:modelValue":a[6]||(a[6]=e=>d(S).guard_name=e),placeholder:"Enter guard name"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}});export{D as default};
