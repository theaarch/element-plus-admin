import{d as e,r as t,S as a,o as l,bO as o,g as s,f as r,C as i,m as d,w as n,a3 as p,i as m,a4 as u,$ as c,e as f,j}from"./index.B9DDwXyn.js";import{v as b}from"./loading.DgVxatZq.js";import{E as h}from"./overlay.CaF_iYQP.js";import{E as _,a as y}from"./radio-group.xG2HYvqK.js";import{E as v}from"./input.h3oSW7Fu.js";import{E as g}from"./input-number.Cq0380tO.js";/* empty css            */import{E as x,a as k}from"./select.DXDT8lei.js";import"./scrollbar.Bhy-xkQk.js";import"./popper.tjIFXnGm.js";import"./tree.hG9d5X2A.js";import"./checkbox.PfgpXjIm.js";import"./text.dsXhSvF4.js";import{E as V}from"./tree-select.DngVr6ky.js";import{E as w}from"./card.BXy-Ncik.js";import{a as C,E}from"./table-column.HahAEEQU.js";/* empty css                */import{E as I,a as U}from"./form-item.D3h4sxEF.js";/* empty css               */import{D as q}from"./dept-api.C6A-cFxd.js";/* empty css                *//* empty css                    */import{E as F}from"./index.C4LHJRvW.js";import{E as z}from"./index.FlroawDi.js";import{E as B}from"./index.BJydFClc.js";import{E as D}from"./index.DN4bf5hU.js";import"./vnode.BymF0sgh.js";import"./index.DI7Lq47c.js";import"./aria.Cpd_B0tV.js";import"./refs.Cw5r5QN8.js";import"./event.BwRzfsZt.js";import"./error.D_Dr4eZ1.js";import"./scroll.iVt-7v8H.js";import"./use-form-common-props.Cfh8sL7v.js";import"./index.BpkllUJ0.js";import"./index.DBPJmu1s.js";import"./typescript.CRqm1_SZ.js";import"./index.CMoYSvzR.js";import"./index.-MvgtnPj.js";import"./index.Cxq1v0nf.js";import"./token.DWNpOE8r.js";import"./strings.DxzcQhMs.js";import"./castArray.CurgOZrE.js";import"./debounce.DpZxVawV.js";import"./toNumber.BgQEYUe1.js";import"./_baseIteratee.D7y0cmdm.js";import"./index.Csx3iWGu.js";import"./index.C8Gfv6TL.js";import"./index.DrJPKNhY.js";import"./_initCloneObject.G0Dih7LI.js";import"./raf.BPqLmvY8.js";import"./_baseClone.O-Y6IxeR.js";const O={class:"app-container"},A={class:"search-container"},R={class:"data-table__toolbar"},S={class:"data-table__toolbar--actions"},T={class:"dialog-footer"},K=e({name:"Dept",inheritAttrs:!1,__name:"Index",setup(e){const K=t(),N=t(),X=t(!1),$=t([]),L=a({}),P=a({title:"",visible:!1}),W=t(),Y=t(),Z=a({status:1,parentId:"0",sort:1}),G=a({parentId:[{required:!0,message:"上级部门不能为空",trigger:"change"}],name:[{required:!0,message:"部门名称不能为空",trigger:"blur"}],code:[{required:!0,message:"部门编号不能为空",trigger:"blur"}],sort:[{required:!0,message:"显示排序不能为空",trigger:"blur"}]});function H(){X.value=!0,q.getList(L).then(e=>{W.value=e,X.value=!1})}function J(){K.value.resetFields(),H()}function M(e){$.value=e.map(e=>e.id)}async function Q(e,t){const a=await q.getOptions();Y.value=[{value:"0",label:"顶级部门",children:a}],P.visible=!0,t?(P.title="修改部门",q.getFormData(t).then(e=>{Object.assign(Z,e)})):(P.title="新增部门",Z.parentId=e||"0")}function ee(){N.value.validate(e=>{if(e){X.value=!0;const e=Z.id;e?q.update(e,Z).then(()=>{B.success("修改成功"),ae(),H()}).finally(()=>X.value=!1):q.create(Z).then(()=>{B.success("新增成功"),ae(),H()}).finally(()=>X.value=!1)}})}function te(e){const t=[e||$.value].join(",");t?D.confirm("确认删除已选中的数据项?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{X.value=!0,q.deleteByIds(t).then(()=>{B.success("删除成功"),J()}).finally(()=>X.value=!1)},()=>{B.info("已取消删除")}):B.warning("请勾选删除项")}function ae(){P.visible=!1,N.value.resetFields(),N.value.clearValidate(),Z.id=void 0,Z.parentId="0",Z.status=1,Z.sort=1}return l(()=>{H()}),(e,t)=>{const a=v,l=I,q=k,B=x,D=F,le=U,oe=E,se=z,re=C,ie=w,de=V,ne=g,pe=y,me=_,ue=h,ce=o("hasPerm"),fe=b;return r(),s("div",O,[i("div",A,[d(le,{ref_key:"queryFormRef",ref:K,model:m(L),inline:!0},{default:n(()=>[d(l,{label:"关键字",prop:"keywords"},{default:n(()=>[d(a,{modelValue:m(L).keywords,"onUpdate:modelValue":t[0]||(t[0]=e=>m(L).keywords=e),placeholder:"部门名称",onKeyup:p(H,["enter"])},null,8,["modelValue"])]),_:1}),d(l,{label:"部门状态",prop:"status"},{default:n(()=>[d(B,{modelValue:m(L).status,"onUpdate:modelValue":t[1]||(t[1]=e=>m(L).status=e),placeholder:"全部",clearable:"",style:{width:"100px"}},{default:n(()=>[d(q,{value:1,label:"正常"}),d(q,{value:0,label:"禁用"})]),_:1},8,["modelValue"])]),_:1}),d(l,{class:"search-buttons"},{default:n(()=>[d(D,{class:"filter-item",type:"primary",icon:"search",onClick:H},{default:n(()=>[...t[10]||(t[10]=[u(" 搜索 ",-1)])]),_:1}),d(D,{icon:"refresh",onClick:J},{default:n(()=>[...t[11]||(t[11]=[u("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),d(ie,{shadow:"hover",class:"data-table"},{default:n(()=>[i("div",R,[i("div",S,[c((r(),f(D,{type:"success",icon:"plus",onClick:t[2]||(t[2]=e=>Q())},{default:n(()=>[...t[12]||(t[12]=[u(" 新增 ",-1)])]),_:1})),[[ce,["sys:dept:add"]]]),c((r(),f(D,{type:"danger",disabled:0===m($).length,icon:"delete",onClick:t[3]||(t[3]=e=>te())},{default:n(()=>[...t[13]||(t[13]=[u(" 删除 ",-1)])]),_:1},8,["disabled"])),[[ce,["sys:dept:delete"]]])])]),c((r(),f(re,{data:m(W),"row-key":"id","default-expand-all":"","tree-props":{children:"children",hasChildren:"hasChildren"},class:"data-table__content",onSelectionChange:M},{default:n(()=>[d(oe,{type:"selection",width:"55",align:"center"}),d(oe,{prop:"name",label:"部门名称","min-width":"200"}),d(oe,{prop:"code",label:"部门编号",width:"200"}),d(oe,{prop:"status",label:"状态",width:"100"},{default:n(e=>[1==e.row.status?(r(),f(se,{key:0,type:"success"},{default:n(()=>[...t[14]||(t[14]=[u("正常",-1)])]),_:1})):(r(),f(se,{key:1,type:"info"},{default:n(()=>[...t[15]||(t[15]=[u("禁用",-1)])]),_:1}))]),_:1}),d(oe,{prop:"sort",label:"排序",width:"100"}),d(oe,{label:"操作",fixed:"right",align:"left",width:"200"},{default:n(e=>[c((r(),f(D,{type:"primary",link:"",size:"small",icon:"plus",onClick:j(t=>Q(e.row.id,void 0),["stop"])},{default:n(()=>[...t[16]||(t[16]=[u(" 新增 ",-1)])]),_:1},8,["onClick"])),[[ce,["sys:dept:add"]]]),c((r(),f(D,{type:"primary",link:"",size:"small",icon:"edit",onClick:j(t=>Q(e.row.parentId,e.row.id),["stop"])},{default:n(()=>[...t[17]||(t[17]=[u(" 编辑 ",-1)])]),_:1},8,["onClick"])),[[ce,["sys:dept:edit"]]]),c((r(),f(D,{type:"danger",link:"",size:"small",icon:"delete",onClick:j(t=>te(e.row.id),["stop"])},{default:n(()=>[...t[18]||(t[18]=[u(" 删除 ",-1)])]),_:1},8,["onClick"])),[[ce,["sys:dept:delete"]]])]),_:1})]),_:1},8,["data"])),[[fe,m(X)]])]),_:1}),d(ue,{modelValue:m(P).visible,"onUpdate:modelValue":t[9]||(t[9]=e=>m(P).visible=e),title:m(P).title,width:"600px",onClosed:ae},{footer:n(()=>[i("div",T,[d(D,{type:"primary",onClick:ee},{default:n(()=>[...t[21]||(t[21]=[u("确 定",-1)])]),_:1}),d(D,{onClick:ae},{default:n(()=>[...t[22]||(t[22]=[u("取 消",-1)])]),_:1})])]),default:n(()=>[d(le,{ref_key:"deptFormRef",ref:N,model:m(Z),rules:m(G),"label-width":"80px"},{default:n(()=>[d(l,{label:"上级部门",prop:"parentId"},{default:n(()=>[d(de,{modelValue:m(Z).parentId,"onUpdate:modelValue":t[4]||(t[4]=e=>m(Z).parentId=e),placeholder:"选择上级部门",data:m(Y),filterable:"","check-strictly":"","render-after-expand":!1},null,8,["modelValue","data"])]),_:1}),d(l,{label:"部门名称",prop:"name"},{default:n(()=>[d(a,{modelValue:m(Z).name,"onUpdate:modelValue":t[5]||(t[5]=e=>m(Z).name=e),placeholder:"请输入部门名称"},null,8,["modelValue"])]),_:1}),d(l,{label:"部门编号",prop:"code"},{default:n(()=>[d(a,{modelValue:m(Z).code,"onUpdate:modelValue":t[6]||(t[6]=e=>m(Z).code=e),placeholder:"请输入部门编号"},null,8,["modelValue"])]),_:1}),d(l,{label:"显示排序",prop:"sort"},{default:n(()=>[d(ne,{modelValue:m(Z).sort,"onUpdate:modelValue":t[7]||(t[7]=e=>m(Z).sort=e),"controls-position":"right",style:{width:"100px"},min:0},null,8,["modelValue"])]),_:1}),d(l,{label:"部门状态"},{default:n(()=>[d(me,{modelValue:m(Z).status,"onUpdate:modelValue":t[8]||(t[8]=e=>m(Z).status=e)},{default:n(()=>[d(pe,{value:1},{default:n(()=>[...t[19]||(t[19]=[u("正常",-1)])]),_:1}),d(pe,{value:0},{default:n(()=>[...t[20]||(t[20]=[u("禁用",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}});export{K as default};
