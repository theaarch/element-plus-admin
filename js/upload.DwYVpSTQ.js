import{d as e,bN as t,bO as l,r as a,I as s,as as i,g as u,f as n,m as r,k as o,i as p,aA as d,w as c,a4 as m,F as f,C as y,E as v,j as g,aG as _,dI as h,e as j,P as b,o as x,h as w}from"./index.CYcHE_Mv.js";import{E as C,a as k}from"./form-item.DTpMQBcG.js";import{E as F}from"./upload.C5qI6n3I.js";import{E as S}from"./progress.Cdac8kcX.js";/* empty css               */import{F as V}from"./file-api.DfTgBINe.js";import{E as z}from"./index.fuyGsFZW.js";import{_ as M}from"./_plugin-vue_export-helper.BCo6x5W8.js";import{E as O,a as I}from"./image-viewer.D331rE5r.js";import{E as N}from"./link.TBcxVQ2R.js";import"./use-form-common-props.DuVqO5gZ.js";import"./castArray.9T1xqkUc.js";import"./error.D_Dr4eZ1.js";import"./_baseClone.Cb83DL7a.js";import"./_initCloneObject.DdvO1N9Q.js";import"./index.BdEBXRF0.js";import"./index.CVqxeg3p.js";import"./aria.Cpd_B0tV.js";import"./debounce.CMIesavh.js";import"./toNumber.-UMwjhYc.js";import"./index.Fr_Zyyhf.js";import"./scroll.lnNidrP9.js";const E={key:0,class:"el-upload-list__item-info"},U=["onClick"],W={class:"el-upload-list__item-file-name"},L=["onClick"],q={key:1,class:"el-upload-list__item-info"},D=M(e({__name:"FileUpload",props:t({data:{type:Object,default:()=>({})},name:{type:String,default:"file"},limit:{type:Number,default:10},maxFileSize:{type:Number,default:10},accept:{type:String,default:"*"},uploadBtnText:{type:String,default:"上传文件"},style:{type:Object,default:()=>({width:"300px"})}},{modelValue:{type:[Array],required:!0,default:()=>[]},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const t=e,h=l(e,"modelValue"),j=a([]);function b(e){return!(e.size>1024*t.maxFileSize*1024)||(_.warning("上传文件不能大于"+t.maxFileSize+"M"),!1)}function x(e){return new Promise((l,a)=>{const s=e.file,i=new FormData;i.append(t.name,s),Object.keys(t.data).forEach(e=>{i.append(e,t.data[e])}),V.upload(i,e=>{const t=s.uid,l=j.value.find(e=>e.uid===t);l&&(l.percentage=e)}).then(e=>{l(e)}).catch(e=>{a(e)})})}s(h,e=>{j.value=e.map(e=>({name:e.name?e.name:e.url?.substring(e.url.lastIndexOf("/")+1),url:e.url,status:"success",uid:Date.now()<<13|Math.floor(8192*Math.random())}))},{immediate:!0});const w=(e,t,l)=>{if(_.success("上传成功"),l.every(e=>"success"===e.status||"fail"===e.status)){const e=[];l.map(t=>{if("success"===t.status){const l=t.response;l&&e.push({name:l.name,url:l.url})}else j.value.splice(j.value.findIndex(e=>e.uid===t.uid),1)}),e.length>0&&(h.value=[...h.value,...e])}},C=e=>{_.error("上传失败")};return(e,l)=>{const a=z,s=i("Document"),_=v,k=i("Close"),M=S,O=F;return n(),u("div",null,[r(O,{"file-list":p(j),"onUpdate:fileList":l[0]||(l[0]=e=>d(j)?j.value=e:null),style:o(t.style),"before-upload":b,"http-request":x,"on-success":w,"on-error":C,accept:t.accept,limit:t.limit,multiple:""},{file:c(({file:e})=>["success"===e.status?(n(),u("div",E,[y("a",{class:"el-upload-list__item-name",onClick:t=>function(e){const{url:t,name:l}=e;t&&V.download(t,l)}(e)},[r(_,null,{default:c(()=>[r(s)]),_:1}),y("span",W,f(e.name),1),y("span",{class:"el-icon--close",onClick:g(t=>{return l=e.url,void V.delete(l).then(()=>{h.value=h.value.filter(e=>e.url!==l)});var l},["stop"])},[r(_,null,{default:c(()=>[r(k)]),_:1})],8,L)],8,U)])):(n(),u("div",q,[r(M,{style:{display:"inline-flex"},percentage:e.percentage},null,8,["percentage"])]))]),default:c(()=>[r(a,{type:"primary",disabled:p(j).length>=t.limit},{default:c(()=>[m(f(t.uploadBtnText),1)]),_:1},8,["disabled"])]),_:1},8,["file-list","style","accept","limit"])])}}}),[["__scopeId","data-v-007ca51b"]]),P=M(e({__name:"SingleImageUpload",props:t({data:{type:Object,default:()=>({})},name:{type:String,default:"file"},maxFileSize:{type:Number,default:10},accept:{type:String,default:"image/*"},style:{type:Object,default:()=>({width:"150px",height:"150px"})}},{modelValue:{type:String,default:()=>""},modelModifiers:{}}),emits:["update:modelValue"],setup(e){h(e=>({v25d788e4:t.style.width??"150px",v424efe59:t.style.height??"150px"}));const t=e,a=l(e,"modelValue");function s(e){return t.accept.split(",").map(e=>e.trim()).some(t=>"image/*"===t?e.type.startsWith("image/"):t.startsWith(".")?e.name.toLowerCase().endsWith(t):e.type===t)?!(e.size>1024*t.maxFileSize*1024)||(_.warning("上传图片不能大于"+t.maxFileSize+"M"),!1):(_.warning(`上传文件的格式不正确，仅支持：${t.accept}`),!1)}function o(e){return new Promise((l,a)=>{const s=e.file,i=new FormData;i.append(t.name,s),Object.keys(t.data).forEach(e=>{i.append(e,t.data[e])}),V.upload(i).then(e=>{l(e)}).catch(e=>{a(e)})})}function p(){}function d(){a.value=""}const m=e=>{_.success("上传成功"),a.value=e.url},f=e=>{_.error("上传失败: "+e.message)};return(e,l)=>{const y=O,_=i("CircleCloseFilled"),h=v,x=i("Plus"),w=F;return n(),j(w,{class:"single-upload","list-type":"picture-card","show-file-list":!1,accept:t.accept,"before-upload":s,"http-request":o,"on-success":m,"on-error":f},{default:c(()=>[a.value?(n(),u(b,{key:0},[r(y,{class:"single-upload__image",src:a.value,"preview-src-list":[a.value],onClick:g(p,["stop"])},null,8,["src","preview-src-list"]),r(h,{class:"single-upload__delete-btn",onClick:g(d,["stop"])},{default:c(()=>[r(_)]),_:1})],64)):(n(),j(h,{key:1},{default:c(()=>[r(x)]),_:1}))]),_:1},8,["accept"])}}}),[["__scopeId","data-v-bd22d71e"]]),A={style:{width:"100%"}},H=["src"],B={class:"el-upload-list__item-actions"},K=["onClick"],Q=["onClick"],Z=e({__name:"MultiImageUpload",props:t({data:{type:Object,default:()=>({})},name:{type:String,default:"file"},limit:{type:Number,default:10},maxFileSize:{type:Number,default:10},accept:{type:String,default:"image/*"}},{modelValue:{type:[Array],default:()=>[]},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const t=e,s=a(!1),o=a(0),m=l(e,"modelValue"),f=a([]);function g(e){return t.accept.split(",").map(e=>e.trim()).some(t=>"image/*"===t?e.type.startsWith("image/"):t.startsWith(".")?e.name.toLowerCase().endsWith(t):e.type===t)?!(e.size>1024*t.maxFileSize*1024)||(_.warning("上传图片不能大于"+t.maxFileSize+"M"),!1):(_.warning(`上传文件的格式不正确，仅支持：${t.accept}`),!1)}function h(e){return new Promise((l,a)=>{const s=e.file,i=new FormData;i.append(t.name,s),Object.keys(t.data).forEach(e=>{i.append(e,t.data[e])}),V.upload(i).then(e=>{l(e)}).catch(e=>{a(e)})})}function C(){_.warning("最多只能上传"+t.limit+"张图片")}const k=(e,t)=>{_.success("上传成功");const l=f.value.findIndex(e=>e.uid===t.uid);-1!==l&&(f.value[l].url=e.url,f.value[l].status="success",m.value[l]=e.url)},S=e=>{_.error("上传失败: "+e.message)},z=()=>{s.value=!1};return x(()=>{f.value=m.value.map(e=>({url:e}))}),(e,l)=>{const a=i("Plus"),_=v,x=i("zoom-in"),M=i("Delete"),O=F,N=I;return n(),u(b,null,[r(O,{"file-list":p(f),"onUpdate:fileList":l[0]||(l[0]=e=>d(f)?f.value=e:null),"list-type":"picture-card","before-upload":g,"http-request":h,"on-success":k,"on-error":S,"on-exceed":C,accept:t.accept,limit:t.limit,multiple:""},{file:c(({file:e})=>[y("div",A,[y("img",{class:"el-upload-list__item-thumbnail",src:e.url},null,8,H),y("span",B,[y("span",{onClick:t=>{return l=e.url,o.value=m.value.findIndex(e=>e===l),void(s.value=!0);var l}},[r(_,null,{default:c(()=>[r(x)]),_:1})],8,K),y("span",{onClick:t=>{return l=e.url,void V.delete(l).then(()=>{const e=m.value.indexOf(l);-1!==e&&(m.value.splice(e,1),f.value.splice(e,1))});var l}},[r(_,null,{default:c(()=>[r(M)]),_:1})],8,Q)])])]),default:c(()=>[r(_,null,{default:c(()=>[r(a)]),_:1})]),_:1},8,["file-list","accept","limit"]),p(s)?(n(),j(N,{key:0,"zoom-rate":1.2,"initial-index":p(o),"url-list":m.value,onClose:z},null,8,["initial-index","url-list"])):w("",!0)],64)}}}),G={class:"app-container"},T=e({__name:"upload",setup(e){const t=a("https://s2.loli.net/2023/05/24/yNsxFC8rLHMZQcK.jpg"),l=a(["https://s2.loli.net/2023/05/24/yNsxFC8rLHMZQcK.jpg"]),s=a([{name:"照片1.jpg",url:"https://s2.loli.net/2023/05/24/yNsxFC8rLHMZQcK.jpg"},{name:"照片2.jpg",url:"https://s2.loli.net/2023/05/24/RuHFMwW4rG5lIqs.jpg"}]);return(e,a)=>{const i=N,o=P,f=C,y=D,v=k;return n(),u("div",G,[r(i,{href:"https://gitee.com/youlaiorg/vue3-element-admin/blob/master/src/views/demo/upload.vue",type:"primary",target:"_blank",class:"mb-10"},{default:c(()=>[...a[3]||(a[3]=[m(" 示例源码 请点击>>>> ",-1)])]),_:1}),r(v,null,{default:c(()=>[r(f,{label:"单图上传"},{default:c(()=>[r(o,{modelValue:p(t),"onUpdate:modelValue":a[0]||(a[0]=e=>d(t)?t.value=e:null)},null,8,["modelValue"])]),_:1}),r(f,{label:"多图上传"},{default:c(()=>[r(Z,{modelValue:p(l),"onUpdate:modelValue":a[1]||(a[1]=e=>d(l)?l.value=e:null),limit:2},null,8,["modelValue"])]),_:1}),r(f,{label:"文件上传"},{default:c(()=>[r(y,{modelValue:p(s),"onUpdate:modelValue":a[2]||(a[2]=e=>d(s)?s.value=e:null)},null,8,["modelValue"])]),_:1})]),_:1})])}}});export{T as default};
